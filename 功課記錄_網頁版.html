<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂπºÂÑøÂõ≠‰Ωú‰∏öËøõÂ∫¶ËøΩË∏™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/lucide@0.544.0/dist/umd/lucide.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #fef7ff;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            overflow: hidden;
            height: 100vh;
            margin: 0;
            padding: 0;
        }

        .page-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .top-page {
            height: 66.67vh;
            overflow: auto;
            padding: 20px;
            box-sizing: border-box;
            border-bottom: 3px solid #e2e8f0;
        }

        .bottom-page {
            height: 33.33vh;
            overflow: auto;
            padding: 20px;
            box-sizing: border-box;
        }

        .celebration-toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #FF6B6B, #FFE66D);
            color: white;
            padding: 20px 40px;
            border-radius: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .celebration-toast.show {
            opacity: 1;
        }

        .container {
            position: relative;
        }

        .container::before,
        .container::after {
            content: '';
            position: fixed;
            width: 300px;
            height: 300px;
            background-repeat: no-repeat;
            background-size: contain;
            opacity: 0.1;
            z-index: -1;
        }

        .container::before {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="%23FF6B6B" d="M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zm-47.2 114.2l-184 184c-6.2 6.2-16.4 6.2-22.6 0l-104-104c-6.2-6.2-6.2-16.4 0-22.6l22.6-22.6c6.2-6.2 16.4-6.2 22.6 0l70.1 70.1 150.1-150.1c6.2-6.2 16.4-6.2 22.6 0l22.6 22.6c6.3 6.3 6.3 16.4 0 22.6z"/></svg>');
            top: -50px;
            right: -50px;
            transform: rotate(15deg);
        }

        .container::after {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="%234ECDC4" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm146.4 349.5c-1.6 1.6-3.5 2.3-5.4 2.3s-3.8-.7-5.4-2.3l-73.1-73.1c-29.4 15.7-63.5 24.2-99.9 24.2-110.5 0-200-89.5-200-200s89.5-200 200-200 200 89.5 200 200c0 36.4-8.5 70.5-24.2 99.9l73.1 73.1z"/></svg>');
            bottom: -50px;
            left: -50px;
            transform: rotate(-15deg);
        }

        .btn-homework {
            transition: all 0.3s ease;
            border: 2px solid #cbd5e1;
            background-color: #fff;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .btn-homework:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .btn-homework:hover {
            transform: scale(1.1);
        }

        .btn-homework.completed {
            background-color: #4ade80;
            color: white;
            box-shadow: 0 0 15px rgba(74, 222, 128, 0.5);
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            border-radius: 50%;
            animation: fall 3s ease-in-out forwards;
        }

        @keyframes fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .student-card {
            transition: all 0.3s ease;
            background-color: #fff;
            border-radius: 20px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
        }

        .student-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4, #FFE66D);
        }

        .student-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .image-container {
            position: relative;
            display: inline-block;
            margin: 10px;
        }

        .image-number {
            position: absolute;
            top: -10px;
            left: -10px;
            background-color: #f43f5e;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .edit-name {
            background: transparent;
            border: none;
            font-size: 1rem;
            font-weight: 700;
            color: #1e293b;
            border-bottom: 2px dashed transparent;
            transition: all 0.3s ease;
            text-transform: capitalize;
        }

        .edit-name:focus {
            outline: none;
            border-bottom: 2px dashed #3b82f6;
        }

        .edit-number {
            background: transparent;
            border: none;
            font-size: 0.875rem;
            color: #64748b;
            width: 30px;
            text-align: center;
        }

        .edit-number:focus {
            outline: none;
            background-color: #e2e8f0;
            border-radius: 4px;
        }


    </style>
</head>
<body class="min-h-screen">
    <div class="page-container">
        <div class="top-page">
            <div class="container mx-auto px-4">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 text-transparent bg-clip-text mb-2">K2A &nbsp;ÂäüË™≤ÂÆåÊàêÊ¶ú</h1>
            <p class="text-lg text-gray-600">Âä†Ê≤πÔºÅ</p>
        </header>

        <main>
            <!-- ÂõæÁâá‰∏ä‰º†Âå∫Âüü -->
            <section class="mb-12">
                <h2 class="text-2xl font-bold text-gray-700 mb-4">ÊúâÁîöÈ∫ºÂäüË™≤Ôºü</h2>
                <div class="text-center mb-6">
                    <label for="fileInput" class="bg-gradient-to-r from-blue-400 to-purple-500 hover:from-blue-500 hover:to-purple-600 text-white font-bold py-3 px-6 rounded-full transition duration-300 ease-in-out transform hover:-translate-y-1 hover:shadow-lg cursor-pointer inline-flex items-center">
                        <i data-lucide="upload-cloud" class="w-6 h-6 mr-2"></i>
                        ‰∏äÂÇ≥ÂäüË™≤ÂúñÁâá
                    </label>
                    <input type="file" id="fileInput" class="hidden" accept="image/*" multiple="">
                </div>
                <div id="imageDisplay" class="flex flex-wrap justify-center"></div>
            </section>


        </main>
            </div>
        </div>
        <div class="bottom-page">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-700">K2A</h2>
                    <button id="resetAll" class="bg-gradient-to-r from-red-400 to-pink-500 hover:from-red-500 hover:to-pink-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out transform hover:-translate-y-1 hover:shadow-lg">
                        <i data-lucide="refresh-cw" class="w-5 h-5 inline-block mr-2"></i>‰∏ÄÈîÆÈáçÁΩÆ
                    </button>
                </div>
                <div id="studentList" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
                    <!-- Â≠¶ÁîüÂç°ÁâáÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>
        </div>
    </div>
    <div id="celebrationToast" class="celebration-toast">
        <span id="celebrationText"></span>
    </div>

    <script>
        lucide.createIcons();

        // ÂàùÂßãÂåñÊï∞ÊçÆ
        let students = JSON.parse(localStorage.getItem('kindergartenStudents')) || Array.from({length: 22}, (_, i) => ({
            id: i + 1,
            name: `Â∞èÊúãÂèã${i + 1}`,
            homeworks: [false, false, false]
        }));

        let homeworkImages = JSON.parse(localStorage.getItem('homeworkImages')) || [];
        let lastSaved = localStorage.getItem('lastSaved') || new Date().toISOString();

        // Ê£ÄÊü•Êï∞ÊçÆÊòØÂê¶ËøáÊúüÔºà7Â§©Ôºâ
        const checkDataExpiry = () => {
            const now = new Date();
            const savedDate = new Date(lastSaved);
            const diffTime = Math.abs(now - savedDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays > 7) {
                localStorage.clear();
                students = Array.from({length: 22}, (_, i) => ({
                    id: i + 1,
                    name: `Â∞èÊúãÂèã${i + 1}`,
                    homeworks: [false, false, false]
                }));
                homeworkImages = [];
                lastSaved = new Date().toISOString();
                saveData();
            }
        };

        // ‰øùÂ≠òÊï∞ÊçÆÂà∞Êú¨Âú∞Â≠òÂÇ®
        const saveData = () => {
            localStorage.setItem('kindergartenStudents', JSON.stringify(students));
            localStorage.setItem('homeworkImages', JSON.stringify(homeworkImages));
            localStorage.setItem('lastSaved', new Date().toISOString());
        };

        // Ê∏≤ÊüìÂ≠¶ÁîüÂàóË°®
        const renderStudents = () => {
            const studentList = document.getElementById('studentList');
            studentList.innerHTML = '';

            students.forEach(student => {
                const card = document.createElement('div');
                card.className = 'student-card bg-white rounded-xl shadow-md overflow-hidden';
                card.innerHTML = `
                    <div class="p-4">
                        <div class="flex justify-between items-center mb-4 relative">
                            <div>
                                <input type="number" value="${student.id}" class="edit-number mr-2" data-id="${student.id}">
                                <input type="text" value="${student.name}" class="edit-name" data-id="${student.id}">
                                ${student.homeworks.every(h => h) ? '<i data-lucide="crown" class="w-6 h-6 text-yellow-400 absolute -top-2 -right-2"></i>' : ''}
                            </div>
                        </div>
                        <div class="flex justify-center space-x-2">
                            ${student.homeworks.map((completed, index) => `
                                <button class="btn-homework w-12 h-12 rounded-full flex items-center justify-center ${completed ? 'completed' : ''}" 
                                        data-student-id="${student.id}" 
                                        data-homework-index="${index}">
                                    <span class="text-lg font-bold">${index === 0 ? '‰∏≠' : index === 1 ? 'Ëã±' : 'Êï∏'}</span>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
                studentList.appendChild(card);
            });

            // Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
            document.querySelectorAll('.edit-name').forEach(input => {
                input.addEventListener('change', (e) => {
                    const studentId = parseInt(e.target.dataset.id);
                    const student = students.find(s => s.id === studentId);
                    if (student) {
                        student.name = e.target.value;
                        saveData();
                    }
                });
            });

            document.querySelectorAll('.edit-number').forEach(input => {
                input.addEventListener('change', (e) => {
                    const studentId = parseInt(e.target.dataset.id);
                    const newNumber = parseInt(e.target.value);
                    if (!isNaN(newNumber) && newNumber > 0) {
                        const student = students.find(s => s.id === studentId);
                        if (student) {
                            student.id = newNumber;
                            e.target.value = newNumber;
                            saveData();
                            renderStudents(); // ÈáçÊñ∞Ê∏≤Êüì‰ª•Êõ¥Êñ∞È°∫Â∫è
                        }
                    }
                });
            });

            document.querySelectorAll('.btn-homework').forEach(button => {
                button.addEventListener('click', toggleHomework);
            });
        };

        // Ê∏≤ÊüìÂõæÁâá
        const renderImages = () => {
            const imageDisplay = document.getElementById('imageDisplay');
            imageDisplay.innerHTML = '';

            homeworkImages.forEach((image, index) => {
                const container = document.createElement('div');
                container.className = 'image-container relative';
                container.innerHTML = `
                    <div class="absolute top-0 right-0 m-2">
                        <button class="delete-image bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center shadow-lg hover:bg-red-600 transition-colors" data-index="${index}">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                    <div class="image-number">${index === 0 ? '‰∏≠' : index === 1 ? 'Ëã±' : 'Êï∏'}</div>
                    <img src="${image}" alt="‰Ωú‰∏ö ${index + 1}" class="max-w-full h-48 object-contain rounded-lg shadow-md">
                `;
                imageDisplay.appendChild(container);
            });
            
            // Ê∑ªÂä†Âà†Èô§ÂõæÁâáÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
            document.querySelectorAll('.delete-image').forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = parseInt(e.currentTarget.dataset.index);
                    homeworkImages.splice(index, 1);
                    saveData();
                    renderImages();
                });
            });
            
            // ÈáçÊñ∞Ê∏≤ÊüìÂõæÊ†á
            lucide.createIcons();
        };

        // ÂàáÊç¢‰Ωú‰∏öÂÆåÊàêÁä∂ÊÄÅ
        const toggleHomework = (e) => {
            const studentId = parseInt(e.target.dataset.studentId);
            const homeworkIndex = parseInt(e.target.dataset.homeworkIndex);
            const student = students.find(s => s.id === studentId);
            
            if (student) {
                student.homeworks[homeworkIndex] = !student.homeworks[homeworkIndex];
                e.target.classList.toggle('completed', student.homeworks[homeworkIndex]);
                saveData();

                // Ê£ÄÊü•ÊòØÂê¶ÊâÄÊúâ‰Ωú‰∏öÈÉΩÂÆåÊàê‰∫Ü
                if (student.homeworks.every(h => h)) {
                    celebrate(studentId);
                    showCelebrationToast(student.name);
                }
            }
        };

        // Â∫ÜÁ•ùÂä®Áîª
        const celebrate = (studentId) => {
            // ÂàõÂª∫ confetti
            for (let i = 0; i < 100; i++) {
                createConfetti();
            }

            // Êí≠ÊîæÈü≥Êïà
            const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3');
            audio.play().catch(e => console.log('Êó†Ê≥ïÊí≠ÊîæÈü≥Êïà:', e));

            // ÊâæÂà∞Â≠¶Áîü
            const student = students.find(s => s.id === studentId);
        };

        // ÂàõÂª∫ confetti
        const createConfetti = () => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            
            // ÈöèÊú∫È¢úËâ≤
            const colors = ['#f00', '#0f0', '#00f', '#ff0', '#f0f', '#0ff'];
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            
            // ÈöèÊú∫‰ΩçÁΩÆÂíåÂ§ßÂ∞è
            confetti.style.left = `${Math.random() * 100}vw`;
            confetti.style.width = `${Math.random() * 10 + 5}px`;
            confetti.style.height = `${Math.random() * 10 + 5}px`;
            
            // ÈöèÊú∫Âä®ÁîªÊåÅÁª≠Êó∂Èó¥ÂíåÂª∂Ëøü
            confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
            confetti.style.animationDelay = `${Math.random() * 2}s`;
            
            document.body.appendChild(confetti);
            
            // Âä®ÁîªÁªìÊùüÂêéÁßªÈô§
            setTimeout(() => {
                confetti.remove();
            }, 5000);
        };

        // ÈáçÁΩÆÊâÄÊúâ‰Ωú‰∏ö
        document.getElementById('resetAll').addEventListener('click', () => {
            if (confirm('Á°ÆÂÆöË¶ÅÈáçÁΩÆÊâÄÊúâÂ∞èÊúãÂèãÁöÑ‰Ωú‰∏öËøõÂ∫¶ÂêóÔºü')) {
                students.forEach(student => {
                    student.homeworks = [false, false, false];
                });
                saveData();
                renderStudents();
            }
        });

        // ÊòæÁ§∫Â∫ÜÁ•ùÊèêÁ§∫
        const showCelebrationToast = (studentName) => {
            const toast = document.getElementById('celebrationToast');
            const text = document.getElementById('celebrationText');
            text.textContent = `${studentName} ÂÆåÊàê‰∫ÜÊâÄÊúâ‰Ωú‰∏öÔºÅÂ§™Ê£í‰∫ÜÔºÅüéâ`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        };

        // ÂõæÁâá‰∏ä‰º†
        const fileInput = document.getElementById('fileInput');

        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                handleFiles(fileInput.files);
            }
        });

        const handleFiles = (files) => {
            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    homeworkImages.push(e.target.result);
                    saveData();
                    renderImages();
                };
                reader.readAsDataURL(file);
            });
        };

        // ÂàùÂßãÂåñ
        checkDataExpiry();
        renderStudents();
        renderImages();
    </script>

</body></html>